import simplekml

def create_segments_kml(input_data, output_filename="segments.kml"):
    """
    Создает KML-файл с отрезками, где каждые две строки входных данных - отдельный отрезок.
    
    :param input_data: Список кортежей в формате [(name, lat, lon), ...]
    :param output_filename: Имя выходного KML-файла
    """
    kml = simplekml.Kml()
    
    # Проверяем, что количество точек четное
    if len(input_data) % 2 != 0:
        print("Предупреждение: Количество точек нечетное. Последняя точка будет проигнорирована.")
    
    # Создаем отрезки для каждой пары точек
    for i in range(0, len(input_data) - 1, 2):
        name1, lat1, lon1 = input_data[i]
        name2, lat2, lon2 = input_data[i+1]
        
        # Создаем линию (отрезок)
        line = kml.newlinestring(name=f"Отрезок {i//2 + 1}: {name1} - {name2}")
        line.coords = [(lon1, lat1), (lon2, lat2)]  # (lon, lat) для KML
        line.altitudemode = simplekml.AltitudeMode.clamptoground
        line.style.linestyle.color = simplekml.Color.red
        line.style.linestyle.width = 3
        
        # Добавляем метки для точек
        kml.newpoint(name=name1, coords=[(lon1, lat1)])
        kml.newpoint(name=name2, coords=[(lon2, lat2)])
    
    # Сохраняем KML-файл
    kml.save(output_filename)
    print(f"Файл '{output_filename}' успешно создан. Откройте его в Google Earth.")

# Пример входных данных (каждые две строки - отдельный отрезок)
# Формат: (название точки, широта, долгота)
segments_data = [
    ("Gef_01_T1",60.92845764543413,	70.14154000606966),
    ("Gef_01_T3",60.9369998349038,70.13584806774199),
    ("Gef_02_T1",60.94288338309561,	70.12271262467692),
    ("Gef_02_T3",60.951424778094896,	70.11701309853441),
    ("Gef_03_T1",60.94581837655321,	70.11310626876002),
    ("Gef_03_T3",60.95265298554473,	70.10854447675611),
    ("Gef_04_T1",60.961514598114675,	70.10203791462523),
    ("Gef_04_T3",60.95383143654939,	70.10718219506946),
    ("Gef_05_T1",60.94635489227825,	70.1024552211083),
    ("Gef_05_T3",60.95489559112451,	70.09673118620312),
    ("Gef_06_T1",60.96116100950487,	70.11663419966995),
    ("Gef_06_T3",60.969693312800906,	70.11091104193986),
    ("Gef_07_T1",60.96276661858792,	70.13403324876336),
    ("Gef_07_T3",60.96874422149469,	70.13003428061121),
    ("Gef_08_T1",60.967213209920615,	70.1380522254099),
    ("Gef_08_T3",60.975755223754966,	70.13235253760517),
    ("Gef_09_T1",60.97381514340928,	70.14094871258644),
    ("Gef_09_T3",60.979792942002746,	70.13694968015216),
    ("Gef_10_T1",60.98279669253711,	70.14592789360411),
    ("Gef_10_T3",60.987916733499446,	70.142507875692),
    ("Gef_11_T1",60.98993149204754,	70.16518769546583),
    ("Gef_11_T3",60.99505200978524,	70.16177002847046),
    ("Gef_12_T1",60.98678998024361,	70.18566330139731),
    ("Gef_12_T3",60.991636405237976,	70.18079712810851),
    ("Gef_13_T1",60.97085054305575,	70.17664549524024),
    ("Gef_13_T3",60.9734155284464,	70.17492965857677),
    ("Gef_14_T1",60.97041509132572,	70.20459913362092),
    ("Gef_14_T3",60.96187007652087,	70.21027847055146)
]


# Создаем KML-файл с отрезками
create_segments_kml(segments_data)